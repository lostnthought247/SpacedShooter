#:kivy 1.11.1


###############################
# Game Objects
###############################

<PlayerShip>
    size: 200, 200
    canvas:
        Ellipse:
            source: root.skin
            pos: self.pos
            size: self.size


###############################
# Screens and Screen Management
###############################

#: import FadeTransition kivy.uix.screenmanager.FadeTransition
ScreenManager:
    transition: FadeTransition()
    IntroScreen:
    BaseScreen:
    CombatScreen:
    ReturnScreen:


<IntroScreen>:
    name : 'Intro'

    # Set the background image for the intro screen.
    Image:
        allow_stretch: True
        keep_ratio: False
        pos: self.pos
        size: self.size
        source: 'space.png'

    BoxLayout:
    BoxLayout:
        orientation: 'vertical'
        Label:
            text: "Spaced Out"
            font_size: 75
            color: 0,0,1,1
        BoxLayout:
            Label:
                id: result
                font_size: 40
                text: ''
        BoxLayout:
            orientation: 'horizontal'
            BoxLayout:

            # Start a new game (goes to "Base" screen).
            Button:
                text: "New Game"
                on_release: app.root.current = 'Base'

            # Load a game (goes to "Return" screen).
            Button:
                text: "Continue"
                on_release: app.root.current = 'Return'

            # Quit the game (terminates the program).
            Button:
                text: "Quit"
                on_release: quit()
            BoxLayout:

        BoxLayout:


<BaseScreen>:
    name : 'Base'

    Image:
        allow_stretch: True
        keep_ratio: False
        pos: self.pos
        size: self.size
        source: 'dock.png'

    BoxLayout:
        orientation: 'horizontal'
        BoxLayout:
            orientation: 'vertical'
            BoxLayout:
                Label:
                    text: "      The Ship Yard"
                    size: self.size
                    font_size: 50
                    size: self.texture_size
            BoxLayout:
            BoxLayout:

            # Back to the main menu.
            Button:
                text: "Main Menu"
                on_release: app.root.current = 'Intro'
        BoxLayout:
            orientation: 'vertical'
            BoxLayout:
            BoxLayout:
                canvas:
                    Color:
                        rgba: 0.01,0.01,0.01,0.80
                    Rectangle:
                        pos: self.pos
                        size: self.size
                Image:
                    # A picture of the selected ship.
                    allow_stretch: True
                    keep_ratio: False
                    pos: self.pos
                    size: self.size
                    source: root.skin
            BoxLayout:
                canvas:
                    Color:
                        rgba: 0,0,0,0.9
                    Rectangle:
                        pos: self.pos
                        size: self.size
                Label:
                    text: """Ship Stats:"""
                BoxLayout:
                    # The currently selected ship's stats
                    canvas:
                        Color:
                            rgba: .05,.05,.05,0.5
                        Rectangle:
                            pos: self.pos
                            size: self.size
                    orientation: 'vertical'
                    BoxLayout:
                        orientation: 'horizontal'
                        Label:
                            text: 'Speed: '
                        Label:
                            text: root.speed
                    BoxLayout:
                        orientation: 'horizontal'
                        Label:
                            text: 'HP: '
                        Label:
                            text: root.hp
                    BoxLayout:
                        orientation: 'horizontal'
                        Label:
                            text: 'Attack: '
                        Label:
                            text: root.attack
                    BoxLayout:
                        orientation: 'horizontal'
                        Label:
                            text: 'Ammo: '
                        Label:
                            text: root.ammo

        BoxLayout:
            orientation: 'horizontal'
            BoxLayout:
                orientation: 'vertical'
                Label:
                    background_color: 1, 1, 1, 1
                    text: ""
                    canvas:
                        Color:
                            # #263238
                            rgba: 0, 0, 0, 0

                        Rectangle:
                            size: self.size
                            pos: self.pos

                # Ship selection
                Button:
                    background_color:  .25, .25, .25, 0.8
                    text: "Speed"
                    shiptype: 'fast'
                    on_release: root.select_ship(self.shiptype)
                    on_release: app.shiptype = self.shiptype
                Button:
                    background_color: .25, .25, .25, 0.8
                    text: "Combat"
                    shiptype: 'basic'
                    on_release: root.select_ship(self.shiptype)
                    on_release: app.shiptype = self.shiptype
                Button:
                    background_color:  .25, .25, .25, 0.8
                    text: "Defense"
                    shiptype: 'tank'
                    on_release: root.select_ship(self.shiptype)
                    on_release: app.shiptype = self.shiptype

                # Start the game
                Button:
                    background_color: 0, 25, 0, 0.5
                    text: "LAUNCH MISSION"
                    on_release: app.root.current = 'Combat'
                    on_release: app.root.get_screen('Combat').shiptype = app.shiptype


#: import Window kivy.core.window.Window
<CombatScreen>
    name: "Combat"
    player: player_ship
    Image:
        allow_stretch: True
        keep_ratio: False
        pos: self.pos
        size: self.size
        source: 'space.png'

    RelativeLayout:
        canvas:
            Rectangle:
                texture: root.score_label.texture
                pos: (0, Window.height - 50)
                size: root.score_label.texture.size
        PlayerShip:
            id: player_ship


<ReturnScreen>:
    name: "Return"
    BoxLayout:
        Button:
            text: 'My settings button'
        Button:
            text: 'Back to menu'
            on_press:
                root.manager.current = 'Intro'
